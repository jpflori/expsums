\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{datetime}
\usepackage{xifthen}

\usepackage{amsmath,amssymb}
\usepackage{mathtools}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage{verbatim}
\usepackage{rotating}
\usepackage{array}
\usepackage[ruled,linesnumbered]{algorithm2e}
\usepackage{tikz}
\usepackage{pgfplots}

\usepackage{xspace}
\newcommand{\ie}{i.e.\@\xspace}
\newcommand{\eg}{e.g.\@\xspace}
\newcommand{\etal}{et al.\@\xspace}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\GF}[2][2]{\mathbb{F}_{#1^{#2}}}
\newcommand{\T}{\mathcal{T}}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\card}[1]{\left| #1 \right|}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Tr}{Tr}
\makeatletter
\newcommand{\tr}[3][1]{\ifthenelse{\isempty{#3}}%
  {\Tr_{#1}^{#2}}%
  {\Tr_{#1}^{#2}\left(#3\right)}}
\newcommand{\addch}[1]{\ifthenelse{\isempty{#1}}%
  {\chi}%
  {\chi \left( #1 \right)}}
\newcommand{\mulch}[1]{\ifthenelse{\isempty{#1}}%
  {\psi}%
  {\psi \left( #1 \right)}}
\makeatother
\newcommand{\Wa}[1]{\widehat{\chi_{#1}}}

\hypersetup{pdftitle={A conjecture about Gauss sums and bentness of binomial Boolean functions},%
  pdfauthor={Jean-Pierre Flori},%
  pdfsubject={Mathematics and Cryptography},%
  pdfcreator={Jean-Pierre Flori},%
  pdfproducer={Jean-Pierre Flori},%
  pdfkeywords={mathematics} {cryptography} {Boolean functions} {bent functions} {Walsh spectrum} {Kloosterman sums},
}

\title{A conjecture about Gauss sums and bentness of binomial Boolean functions}

\author{Jean-Pierre Flori
  \thanks{ANSSI (Agence nationale de la sécurité des systèmes d'information),
    51, boulevard de La Tour-Maubourg,
    75700 Paris 07 SP, France.
    \texttt{jean-pierre.flori@ssi.gouv.fr}}
}

\date{\today~--~\currenttime}
% \date{\today}

\begin{document}

\maketitle

\begin{abstract}
  In this note, the polar decomposition of binary fields of even extension degree is
  used to reduce the evaluation of the Walsh transform of Boolean functions
  within an infinite family in binomial form to that of exponential sums
  over the underlying extensions of odd degree.
  In the case of extensions of degree four times an odd number, an explicit formula
  involving a Kloosterman sum is conjectured and supported by extensive experiments.
  In particular, the validity of this formula would prove a simple and efficient
  characterization conjectured by Mesnager for extensions of degree four times
  an odd number.
\end{abstract}

\noindent
{\bf Keywords}. Boolean functions, bent functions, Walsh spectrum, exponential sums, Gauss sums, Kloosterman sums.


\section{Introduction}
\label{sec:introduction}

Bent functions are Boolean functions achieving optimal non-linearity
and are of both combinatorial and cryptographic interest.
Unfortunately, characterizing bentness is hard,
and even providing simple and efficient criteria within infinite families
of functions in a specific form is a challenging problem.

The simplest characterization for bentness of a function $f$ defined over
defined over $\GF{n}$ with $n = 2 m$ it that its Walsh transform $\Wa{f}$
takes only the values $2^{\pm m}$.
Such a characterization is neither concise nor efficient:
the best algorithm to compute the full Walsh spectrum has complexity $O(n 2^n)$
and this is asymptotically optimal, whence the need to restrict to functions
in a given form and look for more efficient criteria
Unfortunately, only a few infinite families of Boolean functions with a simple and efficient
criterium for bentness are known.

The most classical family is due to Dillon~\cite{MR2624542} and is made of monomial
functions:
\[
f_a(x) = \tr{n}{a x^{r(2^m-1)}} \enspace ,
\]
where $n = 2 m$, $a \in \GF{n}$ and $r$ is co-prime with $2^m + 1$.
Such functions are bent (and even hyper-bent) if and only if the Kloosterman sum $K_m(a)$
associated with $a$ is equal to zero~\cite{MR2624542,DBLP:journals/tit/Leander06,DBLP:journals/tit/CharpinG08}.
Not only does such a criterium gives a concise and elegant characterization for bentness,
but using the connection between Kloosterman sums and elliptic curves~\cite{MR0308088,MR925289,MR1054286}
it also allows to check for it in polynomial time~\cite{DBLP:conf/seta/Lisonek08,DBLP:journals/corr/abs-1104-3882}.
Further results on Kloosterman sums involving $p$-adic arithmetic~\cite{MR2794931,6126036,Moloney:PHD}
lead to even faster generation of zeros of Kloosterman sums and so of (hyper-)bent functions.

Mesnager~\cite{DBLP:journals/dcc/Mesnager11} proved a similar criterium
for a family Boolean functions in binomial form:
\[
f_{a,b}(x) = \tr{n}{a x^{r(2^m-1)}} + \tr{2}{b x^{\frac{2^n-1}{3}}} \enspace ,
\]
where $n = 2 m$, $a \in \GF{n}$, $b \in \GF[4]{}^*$.
To do so, she expressed the Walsh transform of $f_{a,b}$ using the Kloosterman sum $K_m(a)$.
Unfortunately, this expression is only valid when the extension degree $n$ is twice an odd number,
that is when $m$ is odd.
In this case, her results proved that $f_{a,b}$ is (hyper-)bent if and only if $K_m(a) = 4$.
Nonetheless, it is easy to show that $K_m(a) = 4$ is a necessary condition
for $f_{a,b}$ to be bent even when $m$ is even (note that $f_{a,b}$ can not hyper-bent in that case)
and this was conjectured to be true.
Further experimental evidence gathered by Flori, Mesnager and Cohen~\cite{DBLP:journals/iacr/FloriMC11}
supported this conjecture: for $m$ up to $16$, $f_{a,b}$ is bent if and only if $K_m(a) = 4$.

In this note, the polar decomposition of fields of even extension degree is used
to reduce the evaluation of the Walsh transfrom of $f_{a,b}$ to that of exponential sums
over the underlying extensions of odd degree.
In the case of extensions of degree four times an odd number,
that is when $m$ is twice an odd number,
an explicit formula involving the Kloosterman sum $K_m(a)$ is conjectured
and supported by extensive experiments.
In particular, the validity of this formula would prove the characterization
conjectured by Mesnager for extensions of degree four times an odd number.

\section{Notation}

Let $n \geq 2$ be an even integer and
$\nu \geq 1$ denote its $2$-valuation.
We denote by $m_i$ for $0 \leq i \leq \nu$ the integer $n / 2^i$,
\eg $m_0 = n$ and $m_1 = m$ with the notation of the previous section.

For $0 \leq i < \nu$,  the extension degree of $\GF{m_i}$ is even and
it multiplicative group  $\GF{m_i}^*$ can be split using the so-called
polar decomposition
\[
\GF{m_i}^* \simeq U_{i+1} \times \GF{m_{i+1}}^* \enspace ,
\]
where $U_{i+1} \subset \GF{m_i}^*$ is the subgroup of $2^{m_{i+1}}+1$-th roots of unity
and $\GF{m_{i+1}}^*$ the subgroup of $2^{m_{i+1}}-1$-th roots of unity.
Therefore, $\GF{m_0}^*$ can be recursively decomposed as
\[
\GF{m_0}^* \simeq U_1 \times \cdots \times U_\nu \times \GF{m_\nu}^* \enspace .
\]
Let $U$ denote The image of $U_1 \times \cdots \times U_\nu$ within $\GF{m_0}^*$,
that is the set of $(2^{m_1}+1) \cdots (2^{m_\nu}+1)$-th roots of unity.
Then $\GF{m_0}^*$ can be decomposed as
\[
\GF{m_0}^* \simeq U \times \GF{m_\nu}^* \enspace .
\]
Remark that $3$ divides $2^{m_\nu}+1$ and is coprime with $2^{m_\nu}+1$ and $2^{m_i}+1$ for $0 \leq i < \nu$.

%For extension degrees $k$ and $l$ such that $k$ divides $l$,
%the field trace from $\GF{l}$ down to $\GF{k}$ is denoted by $\tr[k]{l}{x}$.

The non-principal additive character of $\GF{}$ is denoted $\addch{}$
and the Walsh transform of a Boolean function $f$ at $\omega \in \GF{m_0}$ is
\begin{align*}
\Wa{f}(\omega) & = \sum_{x \in \GF{m_0}} \addch{f(x) + \tr{m_0}{\omega x}} \enspace ,
\end{align*}
and $f$ is bent if and only if $\Wa{f}(\omega) = 2^{\pm m_1}$ for all $\omega \in \GF{m_0}$.

The Kloosterman sum of $a \in \GF{m_1}$ is
\[
K_{m_1}(a) = \sum_{x \in \GF{m_1}} \addch{\tr{m_1}{a x + \frac{1}{x}}} \enspace .
\]

The non-principal cubic multiplicative character $\mulch{}$ is defined as
\[
\mulch{x} = x^{\frac{2^{m_0}-1}{3}} \enspace ,
\]
for $x \in \GF{m_0}$.

The Boolean functions $f_{a,b}$ studied in this note are defined over $\GF{m_0}$
and given in binomial form:
\begin{align*}
f_{a,b}(x) & = \tr{m_0}{a x^{2^{m_1}-1}} + \tr{2}{b x^{\frac{2^{m_0}-1}{3}}} \\
& = \tr{m_0}{a x^{2^{m_1}-1}} + \tr{2}{b \mulch{x}} \enspace ,
\end{align*}
where $a \in \GF{m_0}$ and $b \in \GF[4]{}^*$.

Dickson polynomials.


\section{Computing the Walsh spectrum}

\subsection{Field of definition of the coefficients}

First notice that it is enough to know how to evaluate the Walsh transform of
functions $f_{a,b}$ for $a \in \GF{m_1}^*$ rather than $\GF{m_0}^*$.
\begin{lemma}
Let $a \in \GF{m_0}^*$ be written as $a = \alpha \tilde{a}$
with $\alpha \in U_1$ and $\tilde{a} \in \GF{m_1}^*$
using the polar decomposition of $\GF{m_0}^*$.
Let $\tilde{\alpha} \in U_1$ be a squareroot of $\alpha$
and $\beta \in \GF[4]{}^*$ be $\beta = \tilde{\alpha}^{(2^{m_0}-1)/3}$.
Then
\begin{align*}
\Wa{f_{a,b}}(\omega) & = \Wa{f_{\tilde{a},\beta b}}(\tilde{\alpha} \omega) \enspace .
\end{align*}
\end{lemma}
\begin{proof}
Indeed, $x \mapsto \tilde{\alpha} x$ induces a permutation of $\GF{m_0}$,
and $\tilde{\alpha}^{2^{m_1}-1} = \tilde{\alpha}^{-2} = \alpha^{-1}$,
so that
\begin{align*}
\Wa{f_{a,b}}(\omega) & = \sum_{x \in \GF{m_0}} \addch{f_{a,b}(x) + \tr{m_0}{\omega x}} \\
& = \sum_{x \in \GF{m_0}} \addch{f_{a,b}(\tilde{\alpha} x) + \tr{m_0}{\omega \tilde{\alpha} x}} \\
& = \sum_{x \in \GF{m_0}} \addch{f_{\tilde{a},\beta b}(x) + \tr{m_0}{\omega \tilde{\alpha} x}} \\
& = \Wa{f_{\tilde{a},\beta b}}(\tilde{\alpha} \omega) \enspace . \qedhere
\end{align*}
\end{proof}
From now on we can suppose that $a \in \GF{m_1}^*$ without loss of generality.

\subsection{Polar decomposition}

We now start splitting the Walsh transform of $f_{a,b}$ at $\omega \in \GF{m_0}$ using the polar decomposition of $\GF{m_0}^*$ as $\GF{m_0}^* = U_1 \times \cdots \times U_\nu \times \GF{m_\nu}^* = U \times \GF{m_\nu}^*$.
We write $x \in \GF{m_0}^*$ as $x = u_1 \cdots u_\nu y = u y$ for $u_i \in U_i$, $u = u_1 \cdots u_\nu \in U$, and $y \in \GF{m_\nu}^*$.
The Walsh transform of $f_{a,b}$ at $\omega \in \GF{m_0}$ can then be written
\begin{align*}
\Wa{f_{a,b}}(\omega) & = \sum_{x \in \GF{m_0}} \addch{f_{a,b}(x) + \tr{m_0}{\omega x}} \\
& = 1 + \sum_{x \in \GF{m_0}^*} \addch{f_{a,b}(x) + \tr{m_0}{\omega x}} \\
& = 1 + \sum_{(u, y) \in U \times \GF{m_\nu}^*} \addch{f_{a,b}(u y)} \addch{\tr{m_0}{\omega u y}} \\
\end{align*}
Note that $3$ divides $2^{m_\nu}+1$ so that $\frac{2^{m_0}-1}{3} = (2^{m_\nu}-1) \frac{2^{m_\nu}+1}{3} \prod_{i=1}^{\nu-1}(2^{m_i}+1)$ and $f_{a,b}(u y) = f_{a,b}(u)$.
Therefore
\begin{align*}
\Wa{f_{a,b}}(\omega) & = 1 + \sum_{u \in U} \addch{f_{a,b}(u)} \sum_{y \in \GF{m_\nu}^*} \addch{\tr{m_\nu}{\tr[m_\nu]{m_0}{\omega u} y}} \enspace .
\end{align*}
The sum ranging over $\GF{m_\nu}^*$ is equal to $-1$ when $\tr[m_\nu]{m_0}{\omega u} \neq 0$ and $2^{m_1}-1$ when $\tr[m_\nu]{m_0}{\omega u} = 0$.

When $\omega = 0$, the Walsh transform is
\begin{align}
\Wa{f_{a,b}}(0) & = 1 + \left( 2^{m_\nu} - 1 \right) \sum_{u \in U} \addch{f_{a,b}(u)} \enspace . \label{eqn:walshzero}
\end{align}

When $\omega \in \GF{m_0}^*$, write its polar decomposition $\omega = w_1 \cdots w_\nu o = w o$ where $(w_1, \ldots, w_\nu, o) \in U_1 \times \cdots U_\nu \times \GF{m_\nu}^*$ and $w = w_1 \cdots w_\nu$.
Then $\tr[m_\nu]{m_0}{\omega u} = 0$ if and only if there exists $1 \leq i \leq \nu$
such that $u_i = w_i^{-1}$.
The Walsh transform is then
\begin{align}
\Wa{f_{a,b}}(\omega) & = 1 - \sum_{u \in U, \tr[m_\nu]{m_0}{\omega u} \neq 0} \addch{f_{a,b}(u)} + (2^{m_\nu} - 1) \sum_{u \in U, \tr[m_\nu]{m_0}{\omega u} = 0} \addch{f_{a,b}(u)} \nonumber \\
& = 1 - \sum_{u \in U} \addch{f_{a,b}(u)} + 2^{m_\nu} \sum_{u \in U, \tr[m_\nu]{m_0}{\omega u} = 0} \addch{f_{a,b}(u)} \enspace . \label{eqn:walshunit}
\end{align}
To go further, the cases $\nu = 1$ and $\nu \geq 2$ have to be dealt with separately.

\section{Odd case}

In this section, it is supposed that $\nu = 1$, \ie $m_1$ is odd and $U = U_1$, which is the case that Mesnager settled~\cite{DBLP:journals/dcc/Mesnager11} and that is recalled here for completeness and because it inspired the treatment of the general case.

For $\omega \neq 0$, $\tr[m_1]{m_0}{\omega u_1} = 0$ if and only if $u_1 = w_1^{-1}$, so that
\begin{align*}
\sum_{u_1 \in U_1, \tr[m_1]{m_0}{\omega u_1} = 0} \addch{f_{a,b}(u_1)}
& = \addch{f_{a,b}(w_1^{-1})} \enspace .
\end{align*}

The only difficulty lies in the computation of $\sum_{u_1 \in U_1} \addch{f_{a,b}(u_1)}$ which can be done by splitting the sum on $U_1$ according to the value of $\mulch{u_1}$:
\begin{align*}
\sum_{u_1 \in U_1} \addch{f_{a,b}(u_1)} & = \sum_{u_1 \in U_1} \addch{f_{a}(u_1)} \addch{\tr{2}{b \mulch{u_1}}} \\
& = \sum_{u_1\in U_1, b \mulch{u_1} = 1} \addch{f_{a}(u_1)} - \sum_{u_1\in U_1, b \mulch{u_1} \neq 1} \addch{f_{a}(u_1)} \\
& = 2 \sum_{u_1\in U_1, b \mulch{u_1} = 1} \addch{f_{a}(u_1)} - \sum_{u_1\in U_1} \addch{f_{a}(u_1)} \enspace .
\end{align*}

It is well known that the second sum is
\begin{align*}
\sum_{u_1 \in U_1} \addch{f_{a}(u_1)} & = 1 - K_{m_1}(a) \enspace .
\end{align*}

As far as the first one is concerned, it is enough to compute it for $b = 1$.
Indeed, set $\beta$ to be a primitive third root of unity (which generates $\GF[4]{}^*$),
then it takes the same value for $b = \beta$ and $b = \beta^2$,
and the sum over these three values has just been computed.

Let $D_3(x) = x^3 + x$ be the third Dickson polynomial of the first kind and $\T_{m_1}^i \subset \GF{m_1}$ denote the set of elements whose inverses have trace $i$ for $i \in \GF{}$.
As $m_1$ is odd, $D_3$ induces a permutation of $\T_{m_1}^0$.
For $b = 1$, one can therefore compute
\begin{align*}
\sum_{u_1 \in U_1, \mulch{u_1} = 1} \addch{f_{a}(u_1)} & = \frac{1}{3} \sum_{u_1 \in U_1} \addch{f_{a}(u_1^3)} \\
& = \frac{1}{3} \sum_{u_1 \in U_1} \addch{\tr{m_1}{a \left( u_1^3 + u_1^{-3} \right)}} \\
& = \frac{1}{3} \sum_{u_1 \in U_1} \addch{\tr{m_1}{a D_3(u_1 + u_1^{-1})}} \\
& = \frac{1}{3} \left( 1 + \sum_{u_1 \neq 1} \addch{\tr{m_1}{a D_3(u_1 + u_1^{-1})}} \right) \\
& = \frac{1}{3} \left( 1 + 2 \sum_{t \in \T_{m_1}^1} \addch{\tr{m_1}{a D_3(t)}} \right) \\
& = \frac{1}{3} \left( 1 + 2 \sum_{t \in \GF{m_1}} \addch{\tr{m_1}{a D_3(t)}} - 2 \sum_{t \in \T_{m_1}^0} \addch{\tr{m_1}{a D_3(t)}} \right) \\
& = \frac{1}{3} \left( 1 + 2 \sum_{t \in \GF{m_1}} \addch{\tr{m_1}{a D_3(t)}} - 2 \sum_{t \in \T_{m_1}^0} \addch{\tr{m_1}{a t}} \right) \\
& = \frac{1}{3} \left( 1 + 2 C_{m_1}(a, a) - K_{m_1}(a) \right) \enspace .
\end{align*}
For $b \neq 1$, one deduces
\begin{align*}
\sum_{u_1 \in U_1, b \mulch{u_1} = 1} \addch{f_{a}(u_1)}
& = \frac{1}{3} \left( 1 - C_{m_1}(a, a) - K_{m_1}(a) \right) \enspace .
\end{align*}

Summarizing the above,
for $\omega = 0$:
\begin{align}
\Wa{f_{a,b}}(0)
= \left\{
\begin{array}{ll}
1 + \frac{2^{m_1}-1}{3} \left( 1 - K_{m_1}(a) - 4 C_{m_1}(a, a) \right) & \text{if $b = 1$ ;} \\
1 + \frac{2^{m_1}-1}{3} \left( 1 - K_{m_1}(a) + 2 C_{m_1}(a, a) \right) & \text{if $b \neq 1$ ;}
\end{array}
\right.
\end{align}
and for $\omega \neq 0$:
\begin{align}
\Wa{f_{a,b}}(\omega)
& = \left\{
\begin{array}{ll}
1 + 2^{m_1} \addch{f_{a,b}(w_1^{-1})} + \frac{1}{3} \left( 1 - K_{m_1}(a) - 4 C_{m_1}(a, a) \right) & \text{if $b = 1$ ;}\\
1 + 2^{m_1} \addch{f_{a,b}(w_1^{-1})} + \frac{1}{3} \left( 1 - K_{m_1}(a) + 2 C_{m_1}(a, a) \right) & \text{if $b \neq 1$.}
\end{array}
\right.
\end{align}

The values of $C_{m_1}(a, a)$ were computed by Carlitz~\cite{MR544577}
and yield a concise and easy to compute formula for the Walsh spectrum
of $f_{a,b}$.
Moreover, Charpin \etal~\cite{4595463,DBLP:journals/dm/CharpinHZ09} derived from Carlitz's results
that $C_{m_1}(a, a) = 0$ if and only if $K_{m_1}(a) \equiv 1 \pmod{3}$.
Together with the Hasse--Weil bound, it is enough to prove that
$f_{a,b}$ is (hyper-)bent if and only if $K_{m_1}(a) = 4$
as noted by Mesnager~\cite{DBLP:journals/dcc/Mesnager11}.

\section{Even case}

In this section, it is supposed that $\nu \geq 2$, \ie both $m_0$ and $m_1$ are even.
The main difference with the case $\nu = 1$ is that $3$ does now divide $2^{m_1}-1$ (in fact $2^{m_\nu}+1$) rather than $2^{m_1}+1$ and $\psi{u}$ does not depend on the value of $u_1$ (but only on that of $u_\nu$).

In particular, the computation of $\sum_{u \in U} f_{a,b}(u)$ is straightforward:
\begin{align*}
\sum_{u \in U} f_{a,b}(u)
& = \prod_{i=2}^{\nu-1} \left( 2^{m_i}+1 \right) \sum_{u_1 \in U_1} \addch{f_a(u_1)} \sum_{u_\nu \in U_\nu} \addch{\tr{2}{b \mulch{u_\nu}}} \\
& = \prod_{i=2}^{\nu-1} \left( 2^{m_i}+1 \right) \frac{2^{m_\nu} + 1}{3} \left( 1 - K_{m_1}(a) \right) \sum_{c \in \GF[4]{}^*} \addch{\tr{2}{b c}} \\
& = - \prod_{i=2}^{\nu-1} \left( 2^{m_i}+1 \right) \frac{2^{m_\nu} + 1}{3} \left( 1 - K_{m_1}(a) \right) \enspace .
\end{align*}
Equation~\ref{eqn:walshzero} therefore becomes
\begin{align}
\Wa{f_{a,b}}(0)
& = 1 - \frac{2^{m_1} - 1}{3} \left( 1 - K_{m_1}(a) \right) \enspace .
\end{align}
As Mesnager~\cite{DBLP:journals/dcc/Mesnager11} showed,
the Hasse--Weil bound on $K_{m_1}(a)$ implies that,
if $f_{a,b}$ is bent, then $\Wa{f_{a,b}}(0) = 2^{m_1}$
and so $K_{m_1}(a) = 4$.

\begin{align*}
\Wa{f_{a,b}}(\omega) & = 1 + \sum_{u \in U_1} \sum_{y \in \GF{m_1}^*} \addch{\tr{m_0}{a u^{2^{m_1}-1}}} \addch{\tr{2}{b u ^{(2^{m_1}+1) \frac{2^{m_1}-1}{3}} y^{(2^{m_1}+1) \frac{2^{m_1}-1}{3}}}} \addch{\tr{m_0}{\omega u y}} \\
& = 1 + \sum_{u \in U_1} \sum_{y \in \GF{m_1}^*} \addch{\tr{m_0}{a u^{2^{m_1}-1}}} \addch{\tr{2}{b y^{(2^{m_1}+1) \frac{2^{m_1}-1}{3}}}} \addch{\tr{m_0}{\omega u y}} \\
& = 1 + \sum_{u \in U_1} \addch{\tr{m_0}{a u^{2^{m_1}-1}}} \sum_{y \in \GF{m_1}^*}  \addch{\tr{2}{b y^{(2^{m_1}+1) \frac{2^{m_1}-1}{3}}}} \addch{\tr{m_0}{\omega u y}} \\
\end{align*}

When $\omega \neq 0$, we only get
\begin{align*}
\Wa{f_{a,b}}(\omega) & = 1 + \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \sum_{y \in \GF{m_2}^*}  \addch{\tr{2}{b (u_2 y)^{(2^{m_1}+1) \frac{2^{m_1}-1}{3}}}} \addch{\tr{m_0}{\omega u_1 u_2 y}} \\
\end{align*}

\subsection{Initial step}

First suppose that $\nu = 2$, that is $m_2$ is odd and $3$ divides $2^{m_2} + 1$,
so that $\frac{2^{m_0}-1}{3} = \left( 2^{m_1} + 1 \right) \left( 2^{m_2} - 1 \right) \frac{2^{m_2}+1}{3}$.
\begin{align*}
\Wa{f_{a,b}}(\omega) & = 1 + \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \sum_{y \in \GF{m_2}^*}  \addch{\tr{2}{b (u_2 y)^{(2^{m_1}+1) (2^{m_2}-1) \frac{2^{m_2}+1}{3}}}} \addch{\tr{m_0}{\omega u_1 u_2 y}} \\
& = 1 + \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \sum_{y \in \GF{m_2}^*} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \addch{\tr{m_0}{\omega u_1 u_2 y}} \\
& = 1 + \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \sum_{y \in \GF{m_2}^*} \addch{\tr{m_0}{\omega u_1 u_2 y}} \\
& = 1 - \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad + \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \sum_{y \in \GF{m_2}} \addch{\tr{m_0}{\omega u_1 u_2 y}} \\
& = 1 - \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad + 2^{m_2} \sum_{(u_1, u_2) \in U_1 \times U_2, \tr[m_2]{m_0}{u_1 u_2 \omega} = 0} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \\
\end{align*}

Remark that the second summand is easily computed as for $\omega = 0$:
\begin{align*}
- \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} & = - \frac{2^{m_2}+1}{3} \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1}} \sum_{c \in \GF[4]{}^*} \addch{\tr{2}{b c}} \\
& = \frac{2^{m_2}+1}{3} (1 - K_{m_1}(a)) \\
\end{align*}

The difficulty lies in computing the third summand (except when $\omega = 0$ where it is nothing but a multiple of the second summand).
Decompose $\omega \neq 0$ as $\omega = \omega_1 \omega_2 o$ with $(\omega_1, \omega_2, o) \in U_1 \times U_2 \times \GF{m_2}^*$.
Then $\tr[m_2]{m_0}{u_1 u_2 \omega_1 \omega_2 o} = \tr[m_2]{m_0}{u_1 u_2 \omega_1 \omega_2} o$ and it is zero if and only if $u_1 = \omega_1^{-1}$, or $u_1 \neq \omega_1^{-1}$ and $u_2 \omega_2 \tr[m_1]{m_0}{u_1 \omega_1} \in \GF{m_2}^*$, that is $u_2$ is equal to the polar part of $\left(\omega_2 \tr[m_1]{m_0}{u_1 \omega_1}\right)^{-1}$ which we denote by $u_2 \sim \left(\omega_2 \tr[m_1]{m_0}{u_1 \omega_1}\right)^{-1}$.
In particular $u_2^{\frac{2^{m_0}-1}{3}} = \left(\omega_2 \tr[m_1]{m_0}{u_1 \omega_1}\right)^{-\frac{2^{m_0}-1}{3}}$
Hence
\begin{align*}
& \sum_{(u_1, u_2) \in U_1 \times U_2, \tr[m_2]{m_0}{u_1 u_2 \omega} = 0} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \\
& = \addch{f_a(\omega_1^{-1})} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad + \sum_{u_1 \neq \omega_1^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}}}} \\
\end{align*}

Then the first summand here is
\begin{align*}
\addch{f_a(\omega_1^{-1})} \sum_{u_2 \in U_2} \addch{\tr{2}{b u_2^{\frac{2^{m_0}-1}{3}}}} & = \frac{2^{m_2}+1}{3} \addch{f_a(\omega_1^{-1})} \sum_{c \in \GF[4]{}^*} \addch{\tr{2}{b c}} \\
& = \frac{2^{m_2}+1}{3} \addch{f_a(\omega_1^{-1})} \sum_{c \in \GF[4]{}^*} \addch{\tr{2}{c}} \\
& = - \frac{2^{m_2}+1}{3} \addch{f_a(\omega_1^{-1})} \\
\end{align*}
so we are left with the second summand.

This second summand reads
\begin{align*}
& \sum_{u_1 \neq \omega_1^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}}}} \\
& = \sum_{u_1 \neq \omega_1^{-1}, b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& \qquad - \sum_{u_1 \neq \omega_1^{-1}, b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}} \neq 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& = 2 \sum_{u_1 \neq \omega_1^{-1}, b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} - \sum_{u_1 \neq \omega_1^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
\end{align*}

The second summand is
\begin{align*}
\sum_{u_1 \neq \omega_1^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} & = 1 - \addch{\tr{m_0}{a \omega_1^{1-2^{m_1}}}} + \sum_{u_1 \neq 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& = 1 - \addch{\tr{m_0}{a \omega_1^{1-2^{m_1}}}} + \sum_{u_1 \neq 1} \addch{\tr{m_0}{a u_1}} \\
& = 1 - \addch{\tr{m_0}{a \omega_1^{1-2^{m_1}}}} - K_{m_1}(a) \\
\end{align*}

\subsubsection{The hard sum}

We are left to compute
\begin{align*}
\sum_{u_1 \neq \omega_1^{-1}, b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{-2}}} \\
\end{align*}
Remark that
\begin{align*}
b \left( \omega_2^{-1} \tr[m_1]{m_0}{u_1 \omega_1}^{-1} \right)^{\frac{2^{m_0}-1}{3}} & = b \left( \omega_2^{-1} \left( u_1 \omega_1 + u_1^{-1}\omega_1^{-1} \right)^{-1} \right)^{\frac{2^{m_0}-1}{3}} \\
& = b \omega_2^{-\left( 2^{m_1} + 1 \right) \left( 2^{m_2} - 1 \right) \frac{2^{m_2}+1}{3}} \left( u_1 \omega_1 + u_1^{-1}\omega_1^{-1} \right)^{- \left( 2^{m_1} + 1 \right) \left( 2^{m_2} - 1 \right) \frac{2^{m_2}+1}{3}} \\
& = b \omega_2^{4 \frac{2^{m_2}+1}{3}} \left( u_1 \omega_1 + u_1^{-1}\omega_1^{-1} \right)^{- 2 \frac{2^{m_1}-1}{3}} \\
\end{align*}

\paragraph{$\omega_1 = 1$:}
We now suppose that $\omega_1 = 1$, that is $\omega \in \GF{m_1}^*$ rather than $\omega \in \GF{m_0}^*$ in full generality.
Then the sum is
\begin{align*}
\sum_{u_1 \neq 1, \left( u_1^2 + u_1^{-2} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-2}}} & = \sum_{u_1 \neq 1, \left( u_1 + u_1^{-1} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-1}}} \\
 & = \sum_{u_1 \neq 1, \left( u_1 + u_1^{-1} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_1}{a \left( u_1 + u_1^{-1} \right)}} \\
& = 2 \sum_{t \in \T_1, t^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_1}{a t}} \\
\end{align*}

First notice that:
\begin{align*}
2 \sum_{t \in \T_1} \addch{\tr{m_1}{a t}} = - K_{m_1}(a) \\
\end{align*}

Define $\gamma \in \GF[4]{}^*$ by $\gamma = b \omega_2^{4 \frac{2^{m_2}+1}{3}}$,
let $c \in \GF[2]{m_1}^*$ be such that $\mulch(c) = \gamma$,
$\alpha = \mulch(a)$,
and let $\beta \in \GF[4]{}^*$ be a primitive third root of unity.
The sum can then be written as
\begin{align*}
2 \sum_{t \in \T_1, \mulch(t) = \gamma} \addch{\tr{m_1}{a t}} & = - \sum_{x \in \GF{m_1}^*, \mulch(x) = \gamma} \addch{\tr{m_1}{a x + 1/x}} + \sum_{x \in \GF{m_1}^*, \mulch(x) = \gamma} \addch{\tr{m_1}{a x}} \\
\end{align*}

Let us now proceed with the first sum.
First remark that summing over the three possible values of $\gamma$ yields
\begin{align*}
\sum_{x \in \GF{m_1}^*} \addch{\tr{m_1}{a x + 1/x}}
& = K_{m_1}(a) - 1 \\
\end{align*}

Moreover, one has
\begin{align*}
\sum_{x \in \GF{m_1}^*, \mulch(x) = \gamma} \addch{\tr{m_1}{a x + 1/x}}
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = \mulch(c)} \addch{\tr{m_1}{a x + 1/x}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{a c x + 1/\left( c x \right)}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{a c / x + x / c}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{a x / (a c) + a c / x}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = \mulch(1 / a c)} \addch{\tr{m_1}{a x + 1 / x}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = \alpha^2 \gamma^2} \addch{\tr{m_1}{a x + 1 / x}} \\
\end{align*}
Therefore, the first sum takes the same value at $\gamma$ and $\alpha^2 \gamma^2$.
As $\gamma$ lies in $\GF[4]{}^*$, this implies that the first sum takes the same value for $\gamma$ ranging over the two different elements of $\GF[4]{}^* \backslash \{ \alpha \}$.
If $\alpha = 1$, that is if $a$ is a cube, then this tells that the first sum takes the same value for $\gamma \in \{ \beta, \beta^2 \}$.

Denote by $r$ a square root of $a$:
\begin{align*}
\sum_{x \in \GF{m_1}^*, \mulch(x) = \mulch(1/r)} \addch{\tr{m_1}{a x + 1/x}}
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{r \left( x + 1/x \right)}} \\
& = \frac{\sum_{x \in \GF{m_1}^*} \addch{\tr{m_1}{r \left( x^3 + 1/x^3 \right)}}}{3} \\
& = \frac{\sum_{x \in \GF{m_1}^*} \addch{\tr{m_1}{r D_3(x + 1/x)}}}{3} \\
& = \frac{2 \sum_{t \in \T_0 \setminus \set{0, 1}} \addch{\tr{m_1}{r D_3(t)}} + 1}{3} \\
& = \frac{2 \sum_{t \in \T_0} \addch{\tr{m_1}{r D_3(t)}} - 1}{3} \\
& = \frac{2 \left( C_{m_1}(r, r) - \sum_{t \in \T_1} \addch{\tr{m_1}{r D_3(t)}} \right) - 1}{3} \\
& = \frac{2 C_{m_1}(r, r) - 2 \sum_{t \in \T_1} \addch{\tr{m_1}{r t}} - 1}{3} \\
& = \frac{2 C_{m_1}(r, r) + K_{m_1}(r) - 1}{3} \\
& = \frac{2 C_{m_1}(a, a) + K_{m_1}(a) - 1}{3} \\
\end{align*}
The possible values of $C_{m_1}(a, a)$ were determined by Carlitz~\cite{MR544577}.
In our case where $m_1$ is even, they depend on $\mulch(a)$, and when $a$ is a cube,
whether the cube root of $a$ has half-trace zero or not.

For our interest, the most important fact is that Carlitz~\cite{MR544577} showed that
$C_{m_1}(a, a) = 0$ if and only if there exists $b \in \GF{m_1}^*$ such that $a = b^3$ (that is $a$ is a cube)
and $\tr[2]{m_1}{b} \neq 0$ (that is the cube root half-trace is non zero),
and that Charpin \etal~\cite{4595463,DBLP:journals/dm/CharpinHZ09} later deduced that 
these conditions are equivalent to $K_{m_1}(a) \equiv 1 \pmod{3}$.

For completeness, the other possibilities given by Carlitz~\cite{MR544577} follow.
When $a$ is a cube and $\tr[2]{m_1}{b} = 0$, then $C_{m_1}(a, a) = 2^{m_2 + 1} \addch{\tr{m_1}{u_0^3}}$,
where $u_0$ is any solution to $u^4 + u = b^4$,
that is $u_0 = \sum_{i=0}^{(m_2-3)/2} b^{4^{2*i+2}} + \gamma$ for any $\gamma \in \GF[4]{}$.
When $a$ is not a cube, then $C_{m_1}(a, a) = - 2^{m_2} \addch{\tr{m_1}{a u_0^3}}$,
where $u_0$ is the unique solution to $u^4 + u / a = 1$ also explicitly given by Carlitz~\cite{MR544577}:
%$u_0 = a^{(4^{m_2}-1)/3} \sum_{i = 0}^{m_2-1} a^{4^i} a^{(4^i - 1)/3}$.
$u_0 = \mulch(a) \sum_{i = 0}^{m_2-1} a^{4^i} a^{(4^i - 1)/3}$.

Therefore, in the case where $K_{m_1}(a) \equiv 1 \pmod{3}$, which includes the case we are ultimately interested in, $K_{m_1}(a) = 4$, the above equality becomes for $\gamma = 1/r = 1$:
\begin{align*}
\sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{a x + 1/x}}
& = \frac{K_{m_1}(a) - 1}{3} \\
\end{align*}
Using the other equalities, it becomes evident that the first sum also takes the same value for $\gamma \neq 1$.

The second sum can also be made explicit using results of Carlitz~\cite{MR544577}.
\begin{align*}
\sum_{x \in \GF{m_1}^*, \mulch(x) = \gamma} \addch{\tr{m_1}{a x}}
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = \mulch(c)} \addch{\tr{m_1}{a x}} \\
& = \sum_{x \in \GF{m_1}^*, \mulch(x) = 1} \addch{\tr{m_1}{a c x}} \\
& = \frac{1}{3} \sum_{x \in \GF{m_1}^*} \addch{\tr{m_1}{a c x^3}} \\
& = \frac{1}{3} C_{m_1}(a c, 0) \\
\end{align*}
As $m_1$ is even, this becomes
\begin{align*}
\sum_{x \in \GF{m_1}^*, \mulch(x) = \gamma} \addch{\tr{m_1}{a x}}
& = \left\{
\begin{array}{ll}
\frac{-1 + (-1)^{m_2-1} 2^{m_2+1}}{3} & \text{if } \mulch(a c) = 1 \\
\frac{-1 + (-1)^{m_2} 2^{m_2}}{3} & \text{if } \mulch(a c) \neq 1 \\
\end{array}
\right. \\
\end{align*}
In particular, its value only depends on $\mulch(a c) = \alpha \gamma$.

To summarize, supposing that $K_{m_1}(a) \equiv 1 \pmod{3}$, one has
\begin{align*}
\sum_{u_1 \neq 1, \left( u_1 + u_1^{-1} \right)^{2 \frac{2^{m_1}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{-2}}} = \frac{2^{m_2+1} - K_{m_1}(a)}{3} \\
\end{align*}
and so that
\begin{align*}
& \sum_{u_1 \neq 1, \left( u_1^2 + u_1^{-2} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-2}}} \\
& \qquad = \frac{2^{m_2+1} - K_{m_1}(a)}{3} - \left( 1 - \addch{\tr{2}{b \omega_2^{4 \frac{2^{m_2}+1}{3}}}} \right) 2^{m_2-1} \\
\end{align*}

\paragraph{$\omega_1 \neq 1$:}
Going back to the case $\omega_1 \neq 1$, \ie $\omega \in \GF{m_0}^*$, and supposing again that $K_{m_1}(a) \equiv 1 \pmod{3}$, the following seems to be true experimentally:
\begin{align*}
& \sum_{u_1 \neq \omega_1^{-1}, \left( (u_1 \omega_1)^2 + (u_1 \omega_1)^{-2} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-2}}} \\
& \qquad = \frac{2^{m_2+1} - K_{m_1}(a)}{3} - \left( 1 - \addch{\tr{??}{??}} \right) 2^{m_2-1} - \left( 1 - \addch{\tr{m_0}{a \omega_1^2}} \right) \frac{2^{m_2-1} - 1}{3} \\
\end{align*}

Assuming $K_{m_1}(a) \equiv 1 \pmod{3}$ and the above formula for the sum is correct and plugging it into Parseval equality yields the following equality:
\begin{align*}
\sum_{x \in \GF{m_0}^*} \addch{\tr{??}{??}} & = \frac{2^{m_1} - 1}{3} \left( K_{m_1}(a) - 1 \right) \\
& = \Wa{f_{a,b}}(0) - 1 \\
\end{align*}
This is supported by experimental evidence that there are exactly $2^{m_1 - 1} + 5 \frac{K_{m_1}(a) - 4}{6} + 3$ (respectively $2^{m_1 - 1} - \frac{K_{m_1}(a) - 4}{6}$) values of $\omega_1 \in U_1$ such that the mysterious trace is zero when $b \mulch(\omega_2) = 1$ (respectively $b \mulch(\omega_2) \neq 1$).


%Indeed
%\begin{align*}
%& \sum_{u_1 \neq \omega_1^{-1}, \left( (u_1 \omega_1)^2 + (u_1 \omega_1)^{-2} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-2}}} \\
%& \qquad = \sum_{u_1 \neq 1, \left( u_1^2 + u_1^{-2} \right)^{\frac{2^{m_1}-1}{3}} = b \omega_2^{4 \frac{2^{m_2}+1}{3}}} \addch{\tr{m_0}{a u_1^{-2} \omega_1^2}} \\
%& \ldots
%\end{align*}

\subsubsection{Summing back}

In the end we get the following (conjectured) formula when $K_{m_1}(a) \equiv 1 \pmod{3}$ and $\omega \neq 0$:
\begin{align*}
\Wa{f_{a,b}}(\omega)
& = 1 + \frac{2^{m_2} + 1}{3} \left(1 - 2^{m_2} \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad - 2^{m_2} \left(1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad + 2^{m_2 + 1} \left( \frac{2^{m_2 + 1} - K_{m_1}(a)}{3}  - \left( 1 - \addch{\tr{??}{??}} \right) 2^{m_2-1} - \left( 1 - \addch{f_a(\omega_1^{-1})} \right) \frac{2^{m_2-1} - 1}{3} \right) \\
& = 2^{m_1} \addch{\tr{??}{??}} + \frac{4 - K_{m_1}(a)}{3}
\end{align*}

This implies in particular that $f_{a,b}$ is bent if and only if $K_{m_1}(a) = 4$.
(The above formula is valid only for $K_{m_1}(a) \equiv 1 \pmod{3}$ but recall that the value of the Walsh transform at $0$ enforces $K_{m_1}(a) = 4$ in all cases.)

\subsection{Further steps}

Let us now suppose $\nu > 2$.
Similarly to the above case, one has
\begin{align*}
& = 1 - \prod_{i=2}^{\nu-1} \left( 2^{m_i} + 1 \right) \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_\nu \in U_\nu} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
\Wa{f_{a,b}}(\omega) & = 1 - \left( 2^{m_2} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_\nu \in U_\nu} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad + 2^{m_\nu} \sum_{(u_1, \ldots,  u_\nu) \in U_1 \times \cdots \times U_\nu, \tr[m_\nu]{m_0}{u_1 \cdots u_\nu \omega} = 0} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
\end{align*}

As above, the first sum (corresponding to $y = 0$) yields
\begin{align*}
& - \left( 2^{m_2} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \sum_{u_1 \in U_1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \sum_{u_\nu \in U_\nu} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad = \left( 2^{m_2} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \frac{2^{m_\nu} + 1}{3} \left( 1 - K_{m_1}(a) \right) \\
& \qquad = \frac{2^{2^{\nu-1} m_\nu} - 1}{3\left(2^{m_\nu} - 1\right)} \left( 1 - K_{m_1}(a) \right) \\
\end{align*}

As above, the second one (summing over $y \in \GF{m_\nu}$) can be decomposed into different summands.
The first one is
\begin{align*}
%& \sum_{u_1 \sim \omega_1^{-1}, u_2 \in U_2, \ldots, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \sum_{u_1 = \omega_1^{-1}, u_2 \in U_2, \ldots, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad = - \left( 2^{m_2} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \frac{2^{m_\nu} + 1}{3} \addch{f_a(\omega_1^{-1})} \\
& \qquad = - \frac{2^{2^{\nu-1} m_\nu} - 1}{3\left(2^{m_\nu} - 1\right)} \addch{f_a(\omega_1^{-1})} \\
\end{align*}
The second one is
\begin{align*}
%& \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, u_3 \in U_3, \ldots, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \sum_{u_1 \neq \omega_1^{-1}, \tr[m_2]{m_0}{u_1 u_2 \omega_1 \omega_2} = 0, u_3 \in U_3, \ldots, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad = - \left( 2^{m_3} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \frac{2^{m_\nu} + 1}{3} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right)
\end{align*}
together with similar terms
\begin{align*}
%& \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_{i} \sim \omega_{i}^{-1} \tr[m_{i-1}]{m_0}{u_1 \omega_1 \cdots u_{i-1} \omega_{i-1}}^{-1}, u_{i+1} \in U_{i+1}, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \sum_{\tr[m_{i-1}]{m_0}{u_1 \cdots u_{i-1} \omega_1 \cdots \omega_{i-1}} \neq 0, \tr[m_i]{m_0}{u_1 \cdots u_i \omega_1 \cdots \omega_i} = 0, u_{i+1} \in U_{i+1}, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad = - 2^{m_2} \cdots 2^{m_{i - 1}} \left( 2^{m_{i+1}} + 1 \right) \cdots \left( 2^{m_{\nu-1}} + 1 \right) \frac{2^{m_\nu} + 1}{3} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right)
\end{align*}
until
\begin{align*}
%& \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_{\nu-1} \sim \omega_{\nu-1}^{-1} \tr[m_{\nu-2}]{m_0}{u_1 \omega_1 \cdots u_{\nu-2} \omega_{\nu-2}}^{-1}, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \sum_{\tr[m_{\nu-2}]{m_0}{u_1 \cdots u_{\nu-2} \omega_1 \cdots \omega_{\nu-2}} \neq 0, \tr[m_\nu-1]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} = 0, u_\nu \in U_\nu} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \qquad = - 2^{m_2} \cdots 2^{m_{\nu - 2}} \frac{2^{m_\nu} + 1}{3} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right)
\end{align*}
which sum back up to
\begin{align*}
& - \frac{2^{\left( 2^{\nu-2} - 1 \right) m_{\nu-1}}-1}{2^{m_{\nu-1}}-1} \frac{2^{m_\nu} + 1}{3} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad = - \frac{2^{2 \left( 2^{\nu-2} - 1 \right) m_{\nu}}-1}{3 \left( 2^{m_{\nu}}-1 \right)} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right)
\end{align*}
as an easy induction shows.
And finally
\begin{align*}
%& \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
& \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \addch{\tr{2}{b u_\nu^{\frac{2^{m_0}-1}{3}}}} \\
\end{align*}

This last sum can be splitted as
\begin{align*}
%& 2 \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
%& \qquad - \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& 2 \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& \qquad - \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
\end{align*}
where the second term is
\begin{align*}
%& - \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& - \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0 } \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& \qquad = - 2^{m_2} \cdots 2^{m_{\nu - 1}} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad = - 2^{2 \left(2^{\nu - 2} - 1\right) m_\nu} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
\end{align*}

This leads to the following expression
\begin{align*}
\Wa{f_{a,b}}(\omega) & = 1 + \frac{2^{2^{\nu-1} m_\nu} - 1}{3\left(2^{m_\nu} - 1\right)} \left( 1 - K_{m_1}(a) \right) \\
& \qquad - 2^{m_\nu} \frac{2^{2^{\nu-1} m_\nu} - 1}{3\left(2^{m_\nu} - 1\right)} \addch{f_a(\omega_1^{-1})} \\
& \qquad - 2^{m_\nu} \frac{2^{2 \left( 2^{\nu-2} - 1 \right) m_{\nu}}-1}{3 \left( 2^{m_{\nu}}-1 \right)} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad - 2^{m_\nu} 2^{2 \left(2^{\nu - 2} - 1\right) m_\nu} \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
%& \qquad + 2^{m_{\nu} + 1} \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& \qquad + 2^{m_{\nu} + 1} \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& = 1 + \frac{2^{2^{\nu-1} m_\nu} - 1}{3\left(2^{m_\nu} - 1\right)} \left( 1 - 2^{m_\nu} \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
& \qquad - \left( \frac{2^{\left( 2^{\nu-1} - 2^{m_\nu} \right) m_{\nu}}-1}{3 \left( 2^{m_{\nu}}-1 \right)} + 2^{\left(2^{\nu - 1} - 1\right) m_\nu} \right) \left( 1 - \addch{f_a(\omega_1^{-1})} - K_{m_1}(a) \right) \\
%& \qquad + 2^{m_{\nu} + 1} \sum_{u_1 \not\sim \omega_1^{-1}, u_2 \not\sim \omega_2^{-1} \tr[m_1]{m0}{u_1 \omega_1}^{-1}, \ldots, u_\nu \sim \omega_{\nu}^{-1} \tr[m_{\nu-1}]{m_0}{u_1 \omega_1 \cdots u_{\nu-1} \omega_{\nu-1}}^{-1}, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
& \qquad + 2^{m_{\nu} + 1} \sum_{\tr[m_{\nu-1}]{m_0}{u_1 \cdots u_{\nu-1} \omega_1 \cdots \omega_{\nu-1}} \neq 0, \tr[m_\nu]{m_0}{u_1 \cdots u_{\nu} \omega_1 \cdots \omega_\nu} = 0, b u_\nu^{\frac{2^{m_0}-1}{3}} = 1} \addch{\tr{m_0}{a u_1^{2^{m_1}-1}}} \\
\end{align*}
which generalizes the case $\nu = 2$.

\section{Conclusion}

\bibliographystyle{plain}
\bibliography{even}

\end{document}
